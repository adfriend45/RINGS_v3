!======================================================================!
SUBROUTINE DIST
!----------------------------------------------------------------------!
! Computes distance of each cell centre from phloem (Î¼m).
!----------------------------------------------------------------------!
USE DOUBLE
USE CONTROL
USE PARAMS
USE STATE
!----------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------!
REAL(DP) :: z_phloem
!----------------------------------------------------------------------!
DO fi = 1, nfi
 z_phloem = f_phloem * pz
 D (fi,1) = z_phloem + L (fi,1) / 2.0_DP
 DO ic = 2, ncells (fi)
  D (fi,ic) = D (fi,ic-1) + L (fi,ic-1) / 2.0_DP + L (fi,ic) / 2.0_DP
 END DO ! ic
END DO ! fi
!----------------------------------------------------------------------!
END SUBROUTINE DIST
!======================================================================!